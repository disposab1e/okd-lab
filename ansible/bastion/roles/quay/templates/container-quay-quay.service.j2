# container-quay-quay.service
# autogenerated by Podman 1.9.3
# Thu Sep 10 11:58:41 CEST 2020

[Unit]
Description=Podman container-quay-quay.service
Documentation=man:podman-generate-systemd(1)
Wants=network.target
After=container-quay-postgres.service
After=container-quay-redis.service
After=container-clair-clair.service
Requires=container-quay-postgres.service
Requires=container-quay-redis.service
Requires=container-clair-clair.service

[Service]
Environment=PODMAN_SYSTEMD_UNIT=%n
TimeoutSec=900

Restart=on-failure
RestartSec=30
ExecStartPre=/usr/bin/rm -f %t/%n-pid %t/%n-cid
ExecStart=/usr/bin/podman run \
    --conmon-pidfile %t/%n-pid \
    --cidfile %t/%n-cid \
    --cgroups=no-conmon \
    --rm \
    -d \
    --privileged \
    --ip {{ okd_lab_quay_ip }} \
    --name=quay-quay \
    -v /var/opt/quay/config:/quay-registry/conf/stack:Z \
    -v /var/opt/quay/storage:/datastorage:Z \
    {{ okd_lab_quay_image }}
ExecStop=/usr/bin/podman stop --ignore --cidfile %t/%n-cid -t 10
ExecStopPost=/usr/bin/podman rm --ignore -f --cidfile %t/%n-cid
PIDFile=%t/%n-pid
KillMode=none
Type=forking

[Install]
WantedBy=multi-user.target default.target
